# sql-project
Написание запросов повышенной сложности

Задача 1
Рассмотрим таблицу Numbers(a int) , представляющую собой последовательность чисел
a
|---------
| 1
| 2
| 3
| 4
| 6
| 7
| 10
| 11
| 12
| 13
| 15
| 17

Задача состоит в том, чтобы вернуть интервалы подряд идущих чисел. Результатом будет таблица из 2 столбцов - ( start , end ):
| start | end
| ----- | ---
| 1 | 4
| 6 | 7
| 10 | 13
| 15 | 15
| 17 | 17




Задача 2
Даны 2 таблицы: Goods - таблица товаров и Orders - таблица заказов.

Таблица Goods имеет структуру:
id - идентификатор товарв
name - название товара

Таблица Orders имеет структуру:
id - идентификатор заказа
dt - дата и время заказа
good_id - идентификатор товара
amount - количество данного товара в данном заказе

Примечание: Очевидно, что одному заказу может соответствовать несколько строк таблицы Orders , т.к. в заказе может быть несколько товаров.

Задача состоит в том, чтобы вывести среднее количество позиций одного вида в заказах с разбивкой по позициям. Необходимые поля:
ID товара
Название товара
Среднее количество в заказе (имя поля - avg_amount)




Задача 3
Рассмотрим таблицу фиксации прохода через турникет gate :
employee - имя сотрудника
check_time - время фиксации прохода
is_entered - вход - 1, выход 0
Известно, что за каждым входом следует выход. В начале дня всегда вход, последний всегда выход.

Необходимо вывести сотрудников и дни, когда они находились на рабочем месте менее 8 часов.

Ответ должен содержать поля:
employee
date (именно дату!)
real_time - сколько реально времени сотрудник был на рабочем месте
